(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{286:function(t,e,a){"use strict";a.r(e);var l=a(28),i=Object(l.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"提额红包功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#提额红包功能"}},[t._v("#")]),t._v(" 提额红包功能")]),t._v(" "),a("h2",{attrs:{id:"获取红包信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取红包信息"}},[t._v("#")]),t._v(" 获取红包信息")]),t._v(" "),a("p",[a("strong",[t._v("需求类型：")])]),t._v(" "),a("ul",[a("li",[t._v("新增接口")])]),t._v(" "),a("p",[a("strong",[t._v("相关系统参数")])]),t._v(" "),a("ul",[a("li",[t._v("参数名：growRedPackBase")]),t._v(" "),a("li",[t._v("说明：提额红包的基础配置")]),t._v(" "),a("li",[t._v("内容示例：")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('{\n    "base":"0.3",\n    "taskType":[\n        "18","19","11","01","20","21","22","23"\n    ],\n    "18":{\n        "totalNum":6,\n        "count":[\n            300,600,1200,300,600\n        ],\n        "sequence":7,\n        "icon":"http:i.shihuowang.com/ui/123.png",\n        "title":"看视频打卡提额",\n        "extraNumDesc":"今日还可打卡次数",\n        "prizeDesc":"可提 0.02 ~ 0.3 元",\n        "btDesc":"马上提额",\n        "showNum":1,\n        "isCount":1,\n        "emphasis":1,\n        "minAmount":"0.01",\n        "maxAmount":"0.02",\n        "param":{\n            "id":"941212470"\n        }\n    }\n}\n')])])]),a("ul",[a("li",[t._v("参数说明：")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("参数")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("子参数")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("base")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("红包的基础值")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("taskType")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("array")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("要显示的任务类型")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("18")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("json")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("任务类型，18 打卡 ； 19 首页点击赚钱；11 看视频；01 豹趣小游戏；20 推啊互动；21 打开日历事项提醒；23 打开推送")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("totalNum")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("每天任务可进行的总次数")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("count")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("array")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("每次打卡后的间隔时间 / 每次玩小游戏需要玩的时间，单位：秒")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("sequence")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("排序，数值越小，返回任务列表越靠前")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("icon")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("任务的图标")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("title")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("任务标题")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("extraNumDesc")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("任务次数描述")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("prizeDesc")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("奖励描述")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("btDesc")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("按钮文字")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("showNum")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是否显示总次数和剩余次数，0 不显示，1 显示")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("isCount")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是否需要倒计时，0 不需要，1 需要")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("emphasis")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是否重点显示，1表示要重点显示，0 表示不重点显示")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("minAmount")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("提额的范围最小值")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("maxAmount")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("提额的范围最大值")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("param")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("json")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("客户端跳转需要的相关参数")])])])]),t._v(" "),a("p",[a("strong",[t._v("新建表")])]),t._v(" "),a("ul",[a("li",[t._v("下文说明使用的表名：user_grow_pkg_line")]),t._v(" "),a("li",[t._v("说明：用户提额的记录表，记录用户提额的记录")]),t._v(" "),a("li",[t._v("下文说明所需字段：")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("字段")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("uid")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("用户标识")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("taskType")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("任务类型，18 打卡 ； 19 首页点击赚钱；11 看视频；01 豹趣小游戏；20 推啊互动；21 打开日历事项提醒；22 关注公众号 ；23 打开推送")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("createOn")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("datetime")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("提额时间")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("money")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("double")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("提额金额")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("status")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("提额记录的状态：0 已完成未领取；1 已领取；2 未完成，主要用于小游戏时长不够")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("time")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("已进行的时长，单位：秒，主要用于记录小游戏玩的时长")])])])]),t._v(" "),a("p",[a("strong",[t._v("新增字段")])]),t._v(" "),a("ul",[a("li",[t._v("表名：user_checkin_line")]),t._v(" "),a("li",[t._v("新增字段名：reserved")]),t._v(" "),a("li",[t._v("说明：表示用户是否预约明天的提额红包，0表示未预约，1表示已预约")])]),t._v(" "),a("p",[a("strong",[t._v("请求参数")]),t._v("\n登录状态获取用户标识uid")]),t._v(" "),a("p",[a("strong",[t._v("返回示例")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('{\n   "base":"0.3",\n   "videoNum":1,\n   "unLockNum":3,\n   "videoTaskNum":1\n   "checkStatus":0,\n   "gameStatus":0,\n   "today":{\n       "status":1,\n       "amount":"0.3"\n   },\n   "tomorrow":{\n       "status":0\n       "amount":"0.7"\n   }\n}\n')])])]),a("p",[a("strong",[t._v("返回参数说明")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("参数名")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("子参数名")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("base")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",[t._v("红包基数：查询系统参数 growRedPackBase 中的base")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("videoNum")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",[t._v("领取【今天红包】已看视频次数："),a("br"),t._v("select count(1) from user_watch_video_line where reward_type = 14 and uid = #用户标识 and date(createOn)=date(now());")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("unLockNum")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",[t._v("领取【今天红包】需要看视频的次数："),a("br"),t._v("1. 统计已看视频数：根据uid，rewar_type='14'查询user_watch_video_line 记录数"),a("br"),t._v("2. 若"),a("code",[t._v("已看视频数")]),t._v(" = 0 ，则返回 1；否则返回 3")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("videoTaskNum")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",[t._v("今天看视频提额次数："),a("br"),t._v("select count(1) from user_grow_pkg_line where taskType = '11' and uid = #用户标识 and date(createOn)=date(now()) and status = 1;")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("checkStatus")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",[t._v("打卡任务状态："),a("br"),t._v('1. 系统参数 growRedPackBase 中的 "18"的 totalNum → 每天可打卡提额的总次数'),a("br"),t._v(" 2. 根据 taskType= '18'，uid，date(createOn)=date(now()),status = 1 查询新表user_grow_pkg_line的记录总数 → 今天用户打卡提额次数"),a("br"),t._v("3. 根据 taskType= '18'，uid，date(createOn)=date(now()),status = 1 查询新表user_grow_pkg_line的记录中最大的createOn  →  上一次打卡时间"),a("br"),t._v('4. 查询系统参数growRedPackBase 中"18"的count中第'),a("code",[t._v("今天用户打卡提额次数")]),t._v("个值  → 打卡间隔 "),a("br"),t._v("判断：若"),a("code",[t._v("每天可打卡提额的总次数")]),t._v(" > "),a("code",[t._v("今天用户打卡提额次数")]),t._v(" && "),a("code",[t._v("上一次打卡时间 + 打卡间隔")]),t._v(" <= 当前时间 ， 即返回 0 ；否则返回 1")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("gameStatus")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",[t._v("玩小游戏任务状态："),a("br"),t._v("1. 根据 taskType= '01'，uid，date(createOn)=date(now()),status = 1 查询新表user_grow_pkg_line的记录总数 → 今天用户玩小游戏提额次数"),a("br"),t._v('2. 查询系统参数growRedPackBase 中"01"的totalNum  →  每天玩小游戏提额总次数 '),a("br"),t._v(" 判断："),a("code",[t._v("今天用户玩小游戏提额次数")]),t._v(" < "),a("code",[t._v("每天玩小游戏提额总次数")]),t._v(" 则返回 0 ，否则 返回 1")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("today")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("json")]),t._v(" "),a("td",[t._v("【今天红包】信息 ，参数的计算逻辑见下文流程图")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("status")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",[t._v("今天红包状态："),a("br"),t._v("0表示 可领取"),a("br"),t._v("1 表示 已领取"),a("br"),t._v("2 表示 未预约")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("amount")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",[t._v("今天红包的金额")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("tomorrow")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("json")]),t._v(" "),a("td",[t._v("【明天红包】信息 ，参数的计算逻辑见下文流程图")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("status")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",[t._v("明天红包状态："),a("br"),t._v("0表示 不可操作"),a("br"),t._v("1 表示 可提额"),a("br"),t._v("2 表示 未预约")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("amount")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",[t._v("明天红包的金额")])])])]),t._v(" "),a("p",[a("strong",[t._v("红包参数计算逻辑")])]),t._v(" "),a("ol",[a("li",[a("p",[t._v("流程：\n")]),a("div",{staticClass:"mxgraph",staticStyle:{"max-width":"100%",border:"1px solid transparent"},attrs:{"data-mxgraph":'{"highlight":"#0000ff","nav":true,"resize":true,"toolbar":"zoom layers lightbox","edit":"_blank","xml":"<mxfile host=\\"Electron\\" modified=\\"2020-05-14T04:03:17.071Z\\" agent=\\"5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.0.3 Chrome/80.0.3987.163 Electron/8.2.1 Safari/537.36\\" etag=\\"oqayUldeNmMq7I4Vxk8N\\" version=\\"13.0.3\\" type=\\"device\\"><diagram id=\\"jbftPopOaGx1PX_JDZkn\\" name=\\"Page-1\\">7Vtbc+MmFP4tfeBxM7ogCT1KttNuJ51pJ51p8rSDLSJrVxaujBN7f31BAutGYjWJIjvJQ2I4AgTnnO/jHLCBPVntfs3xevkHjUgKLCPaAXsKLMu0PMQ/hGRfSnwoBXGeRKXIqATXyU8ieyrpNonIRspKEaM0Zcm6KVzQLCML1pDhPKcPzWZ3NI0agjWOSUdwvcBpV/pPErFlKUWWV8l/I0m8VG82Xb98ssKqsVzJZokj+lAT2TNgT3JKWVla7SYkFcpr6uXykaeHieUkY306XP0d/86+mn99jW++La9YuL+5yr64cm5srxZMIr5+WaU5W9KYZjidVdIwp9ssImJUg9eqNleUrrnQ5MLvhLG9NCbeMspFS7ZK5VM+4Xx/I/sXlVtRuXBUdbqrP5zuZa2cq5jgoyqQog3d5gvyxLpt6Uo4jwl7op1zMBT3cEJXhM+H98tJilly35wHlq4WH9pV1uAFaZD/YRw5yXucbuWbwMwDYQACXnAAmgDkFIVLgLjEBb4DQgPMEAhmIDBFY17wva6N05TjR9jyYZkwcr3GhbIeOISblpITIDkju6d13tWR7GBL95f4h9LjHiowmQohyxqQkDGQUlFXqZaLV2Lh2XwjPgqpYXTEoyKlAsdtAxuDI8XpiRRvTKSY5nGrzi5ByBFjFio6AduOYCPTGNNIjobOfMFlyJUs5rs6gnNBMCnoTBFc21j5kq7m283b0JmLmnyGunzmuG/IZ6ZGrS3v/qVktGwrRhvf8U+A1FR0eRwxcFRa83puVqdn2tEiu/6mdUc1raFhQwjCEKBAcF8AQeD348ci3BNxHyfHqaDIMfnRQe5p8aMGQlxjIVcmFBrzQ+DPZGzgBxxDKZ9QOM95KWaFSjoSjZm6Rjk+YEoXP/7dUkYaxnKFiD9ecfdNMmAHIhRd71r/YflRDGfMaR6RvGya0YwcHqxxFCVZXBtEja4ms2GYcccQHVTM25ouXnFOYIcWc8zTBtmIm6O+CKUdvksjgGaf2tFppwPNBuMegSdOk5gvepqSO/Y6aLU9wc11vJqerQGs2QWsORg1+lrEco8KvQMPlpp+iTJfQXum3+Q6p2du6w7FddD+qPEc7LnpQ2vUTR++g82o9jcQ0ZpHiXaxzb8tKJ+SdWlWvHwWlOt4Xh/KVbJGjGQN5Zf+OfEG2SWs1o3XbtWIvFx1EpUhuMbtyTXWqLmjpUkwWhliTjYkv+cmrAPveA55heck1cNkwbUpOCAUEEkWOA3kg1USRaXXkE3yE8+L8YRh1hzFrFi7EwJn+hTG5BWP7AwOFyt1Iz7h3o8i8otxgXxPvqS3ceRwf4r517Hc7EHv7jbcSdrGPEziBfbt3g6QVBMUfZCsvy8o4SO+8Fy7Kxc1rOY9B0LNIcqJyV6v7w1q/Y3IosjEAnTOxwnIaF0fjX2cYGlCOBl+bNY4q+Kyo2Edf32jR59oT/umZ0SA/d99lnl4Rnasf3yo0+kzDjHeuU7P7mzDQ8aF14q0XQ19+FDF483jDTgQg8DjFzbgRK4oTyCzh1bfjX3UaBtqvmTxaZ9Gw1GvW2Dfr3280xQIPvL1jCoF8hwbvSwFGj7nUc42yKVZe/+rsuMR49/2dZrlw5EDYDjAGeabXxmBwc8wrfcXUHVPLqHin9FOLqEu7z03b3yrIP/4uXo3cWrthWfkrshw+rgrcnTh/3AOq7nd/Dw/eFMYHKfmzxODD7nBmYZK+lW0pbnQf73jAl6tfv1RhsjVb2js2X8=</diagram></mxfile>"}'}}),t._v(" "),a("script",{attrs:{type:"text/javascript",src:"https://app.diagrams.net/js/viewer.min.js"}}),a("p")]),t._v(" "),a("li",[a("p",[t._v("流程说明：")])])]),t._v(" "),a("br"),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("流程")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("获取base")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("查询系统参数 growRedPackBase 中的base")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("领取红包次数")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据 check_type = 2 ,uid 查询user_checkin_line 的记录数")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("今天领取红包记录")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据 check_type = 2 ,uid 查询user_checkin_line 中 date(createOn) = 今天 的记录")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("昨天领取红包记录")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据 check_type = 2 ,uid 查询user_checkin_line 中 date(createOn) = 昨天 的记录")])])])]),t._v(" "),a("h2",{attrs:{id:"获取任务信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取任务信息"}},[t._v("#")]),t._v(" 获取任务信息")]),t._v(" "),a("p",[a("strong",[t._v("需求类型：")])]),t._v(" "),a("ul",[a("li",[t._v("新增接口")])]),t._v(" "),a("p",[a("strong",[t._v("接口说明：")])]),t._v(" "),a("ul",[a("li",[t._v("先查询系统growRedPackBase 中 的taskType ，得到需要返回的任务类型")]),t._v(" "),a("li",[t._v("根据任务类型查询对应的参数")]),t._v(" "),a("li",[t._v("将各个任务类型的json组合成array返回")])]),t._v(" "),a("p",[a("strong",[t._v("请求参数：")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("参数名")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("uid")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("用户标识")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("openCalendar")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是否已开启日历提醒"),a("br"),t._v("1 表示 已开启"),a("br"),t._v("0 表示未开启")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("openPush")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是否已开启推送"),a("br"),t._v("1 表示 已开启"),a("br"),t._v("0 表示未开启")])])])]),t._v(" "),a("p",[a("strong",[t._v("收到请求时优先操作")])]),t._v(" "),a("ul",[a("li",[t._v("若客户端传的openCalendar = 1 ，则下文接口不返回 taskType = '21' 的 任务信息;"),a("br"),t._v("检查user_grow_pkg_line 表中是否有该uid对应的taskType= '21' 的记录，没有则进行以下 2步操作\n"),a("ul",[a("li",[t._v("新增记录：\n"),a("ul",[a("li",[t._v("uid 为 当前用户uid")]),t._v(" "),a("li",[t._v("taskType= '21'")]),t._v(" "),a("li",[t._v("createOn 为 当前时间")]),t._v(" "),a("li",[t._v("status = 1")]),t._v(" "),a("li",[t._v('money：查询系统参数growRedPackBase 中"21"中的minAmount和maxAmount，组成闭区间，在闭区间内随机取值，不小于0.01，只能有 2 位小数')])])]),t._v(" "),a("li",[t._v("提额：update user_checkin_line set next_coin = next_coin + "),a("code",[t._v("#(上一步的money*100)")]),t._v(" where date(createOn)=date(now()) and check_type = 2 and uid = #用户标识")])])]),t._v(" "),a("li",[t._v("若客户端传的openPush = 1，则下文接口不返回 taskType= '23' 的任务信息；"),a("br"),t._v("检查user_grow_pkg_line 表中是否有该uid对应的taskType= '23' 的记录，没有则进行以下 2步操作\n"),a("ul",[a("li",[t._v("新增记录：\n"),a("ul",[a("li",[t._v("uid 为 当前用户uid")]),t._v(" "),a("li",[t._v("taskType= '23'")]),t._v(" "),a("li",[t._v("createOn 为 当前时间")]),t._v(" "),a("li",[t._v("status = 1")]),t._v(" "),a("li",[t._v('money：查询系统参数growRedPackBase 中"21"中的minAmount和maxAmount，组成闭区间，在闭区间内随机取值，不小于0.01，只能有 2 位小数')])])]),t._v(" "),a("li",[t._v("提额：update user_checkin_line set next_coin = next_coin + "),a("code",[t._v("#(上一步的money*100)")]),t._v(" where date(createOn)=date(now()) and check_type = 2 and uid = #用户标识")])])])]),t._v(" "),a("p",[a("strong",[t._v("返回示例")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('[{\n   "icon":"http:i.shihuowang.com/ui/123.png",\n   "title":"看视频打卡提额",\n   "extraNumDesc":"今日还可打卡次数",\n   "prizeDesc":"可提 0.02 ~ 0.3 元",\n   "btDesc":"马上提额",\n   "showNum":1,\n   "totalNum":6,   \n   "extraNum":1,\n   "isCount":1,\n   "count":123456,\n   "status":"1",\n   "taskType":"18",\n   "emphasis":1,\n   "param":{\n       "id":"941212470"\n   }\n},{\n   "icon":"http:i.shihuowang.com/ui/123.png",\n   "title":"首页“点击赚钱”做任务",\n   "extraNumDesc":"完成任务提额，次数不限",\n   "prizeDesc":"可提 0.03~0.5 元",\n   "btDesc":"马上提额",\n   "showNum":0,\n   "status":1,\n   "taskType":"19",\n   "emphasis":1,\n   "param":{}\n}]\n')])])]),a("p",[a("strong",[t._v("返回参数说明")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("参数名")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("icon")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("图标 ：把任务类型作为 key 查询系统参数growRedPackBase  中 icon")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("title")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("粗体标题 ：把任务类型作为 key 查询系统参数growRedPackBase  中 title；"),a("br"),a("br"),t._v("！！！注意：若taskType='01'，需要用"),a("code",[t._v("游戏要求时长")]),t._v("替换title中的 "),a("code",[t._v("%s")]),a("br"),t._v("游戏要求时长："),a("br"),t._v("1. 根据 taskType= '01'，uid，date(createOn)=date(now()),status = 1 查询新表user_grow_pkg_line的记录总数 → 今天用户玩小游戏提额次数"),a("br"),t._v('2. 查询系统参数growRedPackBase 中"01"的count中第'),a("code",[t._v("今天用户玩小游戏提额次数 + 1")]),t._v("个值，由于取到的值单位为秒，需要转换为 分钟，再替换 title中的"),a("code",[t._v("%s")])])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("extraNumDesc")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("：把任务类型作为 key 查询系统参数growRedPackBase  中 extraNumDesc")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("prizeDesc")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("：把任务类型作为 key 查询系统参数growRedPackBase  中 prizeDesc")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("btDesc")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("任务状态为 0 时，按钮显示的文字 ：把任务类型作为 key 查询系统参数growRedPackBase  中 btDesc")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("showNum")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是否显示“总共可领次数”和“剩余可领次数” ：把任务类型作为 key 查询系统参数growRedPackBase  中 showNum")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("totalNum")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("总共可领次数 ：把任务类型作为 key 查询系统参数growRedPackBase  中 totalNum")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("extraNum")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("剩余可领次数："),a("br"),t._v("1. 统计该任务类型已提额的次数：根据taskType，uid，date(createOn)=date(now()) ,status = 1 查询新表user_grow_pkg_line的记录数"),a("br"),t._v("剩余可领次数 = totalNum - "),a("code",[t._v("该任务类型已提额的次数")])])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("count")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("倒计时剩余时间，单位：秒："),a("br"),t._v("1. 把任务类型作为 key 查询系统参数growRedPackBase  中 isCount，若 = 0，则返回 0 ；"),a("br"),t._v("2. 统计该任务类型已提额的次数：根据taskType，uid，date(createOn)=date(now()) ,status = 1 查询新表user_grow_pkg_line的记录数；"),a("br"),t._v("3. 查询count 中的第"),a("code",[t._v("该任务类型已提额的次数")]),t._v("个值，作为下次提额需要的间隔时间，单位：秒"),a("br"),t._v("4. 查询上一次该任务类型提额的时间：根据taskType，uid，date(createOn)=date(now()) ,status = 1 查询新表user_grow_pkg_line中最大的createOn；"),a("br"),t._v("5. 倒计时剩余时间 = "),a("code",[t._v("间隔时间")]),t._v(" - （当前时间 - "),a("code",[t._v("上一次该任务类型提额的时间")]),t._v("）,若<0,则返回 0")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("status")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("状态：0 未完成；1 可领取 ； 2 倒计时中 ； 3 明天再来 "),a("br"),t._v("见下文【任务状态说明】")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("emphasis")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是否显示底色：把任务类型作为 key 查询系统参数growRedPackBase  中 emphasis")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("param")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("json")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("相关的参数：把任务类型作为 key 查询系统参数growRedPackBase  中 param，不用管json中包含什么，直接返回param")])])])]),t._v(" "),a("p",[a("strong",[t._v("任务状态说明")])]),t._v(" "),a("ol",[a("li",[a("p",[t._v("流程\n")]),a("div",{staticClass:"mxgraph",staticStyle:{"max-width":"100%",border:"1px solid transparent"},attrs:{"data-mxgraph":'{"highlight":"#0000ff","nav":true,"resize":true,"toolbar":"zoom layers lightbox","edit":"_blank","xml":"<mxfile host=\\"Electron\\" modified=\\"2020-05-14T08:36:31.916Z\\" agent=\\"5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.0.3 Chrome/80.0.3987.163 Electron/8.2.1 Safari/537.36\\" etag=\\"x-xybIZoUPU02Oc-Ge81\\" version=\\"13.0.3\\" type=\\"device\\"><diagram id=\\"XEIIvDT-c8jBjhwaod4E\\" name=\\"Page-1\\">5VpLk5s4EP41OiYF4iUdsY2zh2ztbM1hd46y0Ri2sOUFeWzn129LCDAGbGczHpxKaqoiNXrA191fP2aQM10fvuRsm/wuYp4hbMUH5MwQxjYOCPynJMdSQl0jWOVpXIqsRvCcfuNmZyXdpTEvjKwUSSEymW7bwqXYbPhStmQsz8W+vexVZHFLsGUr3hE8L1nWlf6VxjIppQQHjfw3nq6S6mbbp+WTNasWmy8pEhaL/YnIiZAzzYWQ5Wh9mPJMgdfGZT7wtH6xnG/kLRvwvxnFy2TO44X9x+5P/uI+4U+2+Y5CHqsv5jEAYKYil4lYiQ3LokY6ycVuE3N1rAWzZs1XIbYgtEH4D5fyaLTJdlKAKJHrzDwt71QXDX6LERVily/5pQ/wjFGwfMXlpYV+jTkYKxdrLvMjbMx5xmT61n4TZqxmVa9rgIWBwfZ7cDav+caynbkKRR4iBIUuinxEfRTOUOSiyUT9qEchCm0UBWow8dUaYiFid9WVZeALSi37JJX8ecs0XntwxzboLEtXGxgvAWOe11p447nkh8t66KJmNmDjzMa5XVxO942n2JX5JydeQqx7wUy7MGOfrRUUm0Wx1V9t5iupZmqN1Qc8KGSOyFxJQEUh1Y/mSqhUMUcUdlEUYkRnSks0RMQ1WlLnwPapOYd6aGJ19XZ/NwMl5se/1f7PXjV9McfpyezQmh3N7D3d07/VPcmY7lkdfGI3PAOnGlVpLZU1GnwgpWH8g0ozW59ECu9Ys4pbufGxirbtE8r3MpvONF+/xQ+QiN/L1ZMATXCf81919TwR68WuuE7R78HIFr5KyZ7/kZRMOmgWkkmAA3hXs68DlJwpMl7kMCppWWFJEIna9AvYa7wB9dDrwtxyvTGiYRXrDPZ24N0WD/17gY/dXlOGVAPQhQEFwyW/aGjC+FaWc0YNTX1sBOkK0b7wCLocRSfeqDrBQ5ymQFT5ZJ0Q6sQSUsqGx7oBBIqASMUNFWRmKoaMGUDcMxIbPYDgbgA5cQCq7B7uViD6vfXRr0Fmt5bBZeNiLMdxrB5dPoIKR1EFHZXD+joSOusKddELDAXa6CpH5WEWotjQlsl7A9WjGJO2fOd6K+JDacvBI1MRpc5ZBRlcqyH17InnKUCgkuJSeEjlCbnB7KW6DMbNSWpyD2ajH8Vs/cUoxS5A2fxrm1md4n9Qbeo4Xa8danBlTYPL6i7qsc2vbMGzK2WSctJ0ybLQPFincVyaLi/Sb2yhz1MmsFUQaFC8CfJml7zc9O7NZlSXUafmcsHHBjnhk/U5oIHxw/9rBtUS8fpa8PvotIeJLzYtb9PmTxQxb3Vxxx01YvY0l1U0pDqtd3XuTi/Fx2ZA9cAdNWISN3isiIm73HbWKbL7OkV1W17XU8Q3EtqTj4zdIHKdgegxXoMouIa5NdCdm6KwrGojRKa6qiUqZ3w4zP3Khh8Gc6fblDvDHA/Y+RCv6Go4nD0e+Lblt7sJXg/JvBP4MG1+mV7G5uZPEpzoPw==</diagram></mxfile>"}'}}),t._v(" "),a("script",{attrs:{type:"text/javascript",src:"https://app.diagrams.net/js/viewer.min.js"}}),a("p")]),t._v(" "),a("li",[a("p",[t._v("流程说明")])])]),t._v(" "),a("br"),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("流程")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("已提额次数")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据taskType，uid，date(createOn)=date(now()) ,status = 1 查询新表user_grow_pkg_line的记录数")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("任务每天可提额的总次数")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("把任务类型作为 key 查询系统参数growRedPackBase  中 totalNum")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("status=0 的今天提额记录")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据taskType，uid，date(createOn)=date(now()) ,status = 0 查询新表user_grow_pkg_line的记录")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("是否需要倒计时")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("把任务类型作为 key 查询系统参数growRedPackBase  中 isCount")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("剩余倒计时时间")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("同上一点 count")])])])]),t._v(" "),a("h2",{attrs:{id:"_3-完成任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-完成任务"}},[t._v("#")]),t._v(" 3. 完成任务")]),t._v(" "),a("p",[a("strong",[t._v("需求类型")])]),t._v(" "),a("ul",[a("li",[t._v("新增接口")])]),t._v(" "),a("p",[a("strong",[t._v("请求参数：")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("参数名")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("uid")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("用户标识")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("taskType")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("任务类型")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("isFinish")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是否直接提额，0 不直接提额； 1 直接提额")])])])]),t._v(" "),a("p",[a("strong",[t._v("操作说明")])]),t._v(" "),a("ol",[a("li",[t._v("在user_grow_pkg_line 表中新增记录：\n"),a("ol",[a("li",[t._v("uid 为 当前用户uid")]),t._v(" "),a("li",[t._v("taskType 为客户端传的taskType")]),t._v(" "),a("li",[t._v("createOn 为 当前时间")]),t._v(" "),a("li",[t._v("status 为客户端传的 isFinish")]),t._v(" "),a("li",[t._v("money：将客户端传的taskType 作为 key 查询系统参数growRedPackBase 中的minAmount和maxAmount，组成闭区间，在闭区间内随机取值，不小于0.01，只能有 2 位小数")])])]),t._v(" "),a("li",[t._v("若 isFinish = 1 ，需要进行以下 2 步操作：\n"),a("ol",[a("li",[t._v("提额：update user_checkin_line set next_coin = next_coin + "),a("code",[t._v("#(上一步的money*100)")]),t._v(" where date(createOn)=date(now()) and check_type = 2 and uid = #用户标识")]),t._v(" "),a("li",[t._v("返回 提额的金额（money），提额后的金额（next_coin/100）给客户端")])])])]),t._v(" "),a("p",[a("strong",[t._v("返回示例")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('{\n   "prizeAmount":"0.02",\n   "nowAmount":"0.32"\n}\n')])])]),a("p",[a("strong",[t._v("返回参数说明")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("参数名")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("prizeAmount")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("本次提额金额 ： 提额的金额（新增记录时计算的money）")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("nowAmount")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("当前红包金额  ：提额后的 next_coin/100 （由于原本是金币，所以需要除以100，以字符串返回）")])])])]),t._v(" "),a("h2",{attrs:{id:"_4-提额"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-提额"}},[t._v("#")]),t._v(" 4. 提额")]),t._v(" "),a("p",[a("strong",[t._v("需求类型")])]),t._v(" "),a("ul",[a("li",[t._v("新增接口")])]),t._v(" "),a("p",[a("strong",[t._v("请求参数：")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("参数名")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("uid")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("用户标识")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("taskType")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("任务类型")])])])]),t._v(" "),a("p",[a("strong",[t._v("操作说明")])]),t._v(" "),a("ol",[a("li",[t._v("根据uid，taskType ，date（createOn)=date(now()),status = 0 查询 user_grow_pkg_line 的记录，将createOn最大的一条记录status 修改为 1")]),t._v(" "),a("li",[t._v("提额：update user_checkin_line set next_coin = next_coin + "),a("code",[t._v("#(上一步修改的记录的money*100)")]),t._v(" where date(createOn)=date(now()) and check_type = 2 and uid = #用户标识")]),t._v(" "),a("li",[t._v("返回 提额的金额（money），提额后的金额（next_coin/100）给客户端")])]),t._v(" "),a("p",[a("strong",[t._v("返回示例")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('{\n   "prizeAmount":"0.02",\n   "nowAmount":"0.32"\n}\n')])])]),a("p",[a("strong",[t._v("返回参数说明")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("参数名")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("prizeAmount")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("本次提额金额 ： 提额的金额（修改的记录的money）")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("nowAmount")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("当前红包金额  ：提额后的 next_coin/100 （由于原本是金币，所以需要除以100，以字符串返回）")])])])]),t._v(" "),a("h2",{attrs:{id:"_5-领取红包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-领取红包"}},[t._v("#")]),t._v(" 5. 领取红包")]),t._v(" "),a("p",[a("strong",[t._v("需求类型")])]),t._v(" "),a("ul",[a("li",[t._v("新增接口")])]),t._v(" "),a("p",[a("strong",[t._v("操作说明")])]),t._v(" "),a("ol",[a("li",[a("p",[t._v("流程\n")]),a("div",{staticClass:"mxgraph",staticStyle:{"max-width":"100%",border:"1px solid transparent"},attrs:{"data-mxgraph":'{"highlight":"#0000ff","nav":true,"resize":true,"toolbar":"zoom layers lightbox","edit":"_blank","xml":"<mxfile host=\\"Electron\\" modified=\\"2020-05-14T10:19:25.201Z\\" agent=\\"5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.0.3 Chrome/80.0.3987.163 Electron/8.2.1 Safari/537.36\\" etag=\\"PO8sAdDUYP6US36HKrAO\\" version=\\"13.0.3\\" type=\\"device\\"><diagram id=\\"2cW0so2pr6jiRF97L81o\\" name=\\"Page-1\\">5Vpdj9o4FP0t++DHjmLn+zGB0K7USiuNVtv2zRBDskowMmGA/vq1HYfEJKTpDBBmOw8z9sF2nOt7zz2+AzAn+eEjw5vkC41JBpARH4A5BQi5ls9/C+BYArbtlMCKpXEJGTXwnP4gJQgrdJfGZKuwEioozYp0o4MLul6TRaFhmDG614ctaRZrwAavSAt4XuCsjf6TxkVSoh5ya/wTSVdJ9WToqBfOcTVYvck2wTHdNyAzAuaEUVqUrfwwIZmwnW6X2YVPTxtjZF0MmfAlzNl3YvyJ6fJvmM8XaDlZfjDV3opj9cIk5u+vupQVCV3RNc6iGg0Z3a1jIlY1eK8e85nSDQchB/8lRXFUh4l3BeVQUuSZ+rR8pnjQxVdR0Jbu2IL07L9yCcxWpOgZh04G545KaE4KduTzGMlwkb7o+8DKZVancbVVeUMZ9heMrNZ9wdlOPQlEPggQ8BwQ2cCbAZ83XBAGAhTIBHg2iDwQzEDogsgBIQQeap9VlvE4EGeyT9KCPG+wNNaeR2KXxV8IK8ih3+ZtG6kJlnIVFceOCuN9HRSw8vSkERCecSOj2m2jjuDK3Hjs+FXMf7Kr7je1nOxMD1rvqHrXDAF7YAxYY8aA23FcDs6Fn67nW/HnD2maM/A3PVM08Ei9Nx6pmvoXTfkO61C3oBbr0HD0Jcp9qVlnjnHaxut9BXXwpS2IMESCJn3OjqFkR1cyqKRSHwqa9Pkwo+UzLKH5fLe9C02epvTwZCWB7sKTsMOav2dQWQODCrpjEqXV4fyOEAjcsUUUhEImdIiFtqDgARJVs6YiNFpxoR3qHSSEbWmxgQw0TEQ4NwuOLmnWsLYglqiXcx7eyJY7UKndzMj+uHyjsU1NPhf4hhzS4mu1Bm83ZvFePUl0bsBR3lCOsq+R+QPG8LExYCMy+rZHGJhID2DTbHrHT8dXQqL2pnIHV1UPVeWgR2pKtCKfM7/8jOck030JZ+lqzdsLfpyEcUAEaLrAWaA+yNM4Lt2WbNMfeC7XE56hDMoXt0NgT/siXBUw1GRwKhs0vehyeF2kgw/Gk4dsVzuG6kL6WplYDaHL5ZbcRAHCUeoSb+WMmie+NRjkcTjjQuK4UxGkQ9h03AD/J0FZOnBfVEITOXpUmo8elV6HWLKEIvUCKZYsEPjv96YGfbMtlO57VeuoaXHjeZEsAvYUCn3gudKupYGnDydCR9eg0BkoCh6sAvVrieiKSWVoBeo6QrSlHE3XfTIaP9068rRg+TqtglRrWRue30BNfaEbV7ZgB4WO4F9X9BPovw/10VF/7rjoO5JjDcGxXnmtf/j7vTl+EcXvsC03VyRMJwTCDARQyoEQhJY0Mv/Ilg0f8KzLG8FEjEdOxjcbzhlvrUQLRDMQ8hznyXV4KpzKHBeIxFf+e8yD8vhcuY4tzk6MKWe1Cw+jH1a1p9EOC3Xdjt83A7lDGejCTfmNqeo8p5gOuk5yshxby4FnO3t1quLd+lsH5fD6qxtm9B8=</diagram></mxfile>"}'}}),t._v(" "),a("script",{attrs:{type:"text/javascript",src:"https://app.diagrams.net/js/viewer.min.js"}}),a("p")]),t._v(" "),a("li",[a("p",[t._v("流程说明")])])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("流程")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("已看视频数")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据uid，rewar_type='14'查询user_watch_video_line 记录数")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("今天已看视频数")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据reward_type = '14'，uid，date(createOn)=date(now()) 查询 user_watch_video_line 表 中的记录数")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("获取红包金额")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据uid，check_type = 2，date(createOn)=date(date_sub(now(),interval 1 day)) 查询 user_checkin_line 表中的next_coin , 除以 100")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("新建红包领取记录")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("在user_checkin_line中新增记录："),a("br"),t._v("    uid 为用户标识"),a("br"),t._v("    idx = 0"),a("br"),t._v("    cur_coin 为上一步的next_coin（保持金币，不除以100）"),a("br"),t._v("    next_coin 为 查询系统参数growRedPackBase 中的base ，乘以 100 "),a("br"),t._v("    createOn为当前时间"),a("br"),t._v("    check_type = 2"),a("br"),t._v("    tid为null"),a("br"),t._v("    reserved = 0")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("新增提现记录")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("在fn_withdrawal_record中新增记录："),a("br"),t._v("    uid 为用户标识"),a("br"),t._v("    user_account 为用户手机"),a("br"),t._v("    withdrawal_money和receive_money 为 "),a("code",[t._v("获取红包金额")]),a("br"),t._v("    handler_money = 0 "),a("br"),t._v("    withdrawal_time 和 add_time 为当前时间"),a("br"),t._v("    withdrawal_type = 2 "),a("br"),t._v("    status = 1"),a("br"),t._v("    invalid_flag=0"),a("br"),t._v("    account_type = '03'"),a("br"),t._v("    advance_pay=0")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("微信直接打款（不验证姓名）")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("1. 根据"),a("code",[t._v("获取红包金额")]),t._v(" ，使用微信企业付款到零钱，打款到用户的微信，不验证姓名"),a("br"),t._v("2. 若打款成功，修改上一步新增的fn_withdrawal_record记录："),a("br"),t._v("    status 修改为 3"),a("br"),t._v("    check_user_id = 0"),a("br"),t._v("    check_user_account = 'system'"),a("br"),t._v("    receive_time 为当前时间"),a("br"),t._v("    receive_pay_no 为微信回调的回执"),a("br"),t._v("3. 若打款失败，将fn_withdrawal_record记录 的status 修改为  4")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("新增看视频记录")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("在user_watch_video_line 表中新增记录："),a("br"),t._v("    uid 为当前用户标识"),a("br"),t._v("    user_account 为当前用户的手机号"),a("br"),t._v("    check_id:若新增红包领取记录，则为新增的user_checkin_line记录的id；若没走新增红包领取记录，则为 0 "),a("br"),t._v("    createOn为当前时间"),a("br"),t._v("    reward_type = '14'")])])])]),t._v(" "),a("h2",{attrs:{id:"_6-预约红包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-预约红包"}},[t._v("#")]),t._v(" 6. 预约红包")]),t._v(" "),a("p",[a("strong",[t._v("需求类型")])]),t._v(" "),a("ul",[a("li",[t._v("新增接口")])]),t._v(" "),a("p",[a("strong",[t._v("操作说明")]),t._v("\nupdate user_checkin_line set reserved = 1 where date(createOn)=date(now()) and check_type = 2 and uid = #用户标识")]),t._v(" "),a("h2",{attrs:{id:"_7-游戏赚回调→完成任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-游戏赚回调→完成任务"}},[t._v("#")]),t._v(" 7. 游戏赚回调→完成任务")]),t._v(" "),a("p",[a("strong",[t._v("需求类型")])]),t._v(" "),a("ul",[a("li",[t._v("原接口后新增操作")])]),t._v(" "),a("p",[a("strong",[t._v("接口")])]),t._v(" "),a("ul",[a("li",[t._v("多游："),a("code",[t._v("http://www.shihuowang.com/api/dy-pwall/callback")])]),t._v(" "),a("li",[t._v("享玩："),a("code",[t._v("http://www.shihuowang.com/api/xw-pwall/callback")])])]),t._v(" "),a("p",[a("strong",[t._v("操作说明")]),t._v("\n执行上文第 3 个 接口【完成任务】"),a("br"),t._v("\n传参：taskType = '19';isFinish = 0")]),t._v(" "),a("h2",{attrs:{id:"_8-任务赚审核通过→完成任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-任务赚审核通过→完成任务"}},[t._v("#")]),t._v(" 8. 任务赚审核通过→完成任务")]),t._v(" "),a("p",[a("strong",[t._v("需求类型")])]),t._v(" "),a("ul",[a("li",[t._v("原接口后新增操作")])]),t._v(" "),a("p",[a("strong",[t._v("接口")])]),t._v(" "),a("ul",[a("li",[t._v("管理后台任务审核接口："),a("code",[t._v("/app-task/user-attend/audit")]),t._v(" 需要前端传 status = '03',表示审核通过")]),t._v(" "),a("li",[t._v("移动端任务管理后台审核接口："),a("code",[t._v("/my/seller-app-task/audit")]),t._v("需要前端传 status = '03',表示审核通过")])]),t._v(" "),a("p",[a("strong",[t._v("操作说明")]),t._v("\n执行上文第 3 个 接口【完成任务】"),a("br"),t._v("\n传参：taskType = '19';isFinish = 0")]),t._v(" "),a("h2",{attrs:{id:"_8-豹趣小游戏关闭→完成任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-豹趣小游戏关闭→完成任务"}},[t._v("#")]),t._v(" 8. 豹趣小游戏关闭→完成任务")]),t._v(" "),a("p",[a("strong",[t._v("需求类型")])]),t._v(" "),a("ul",[a("li",[t._v("原接口后新增操作")])]),t._v(" "),a("p",[a("strong",[t._v("接口")])]),t._v(" "),a("ul",[a("li",[t._v("管理后台任务审核接口："),a("code",[t._v("/api/little-game/callback")]),t._v(" 无论传")])]),t._v(" "),a("p",[a("strong",[t._v("操作说明")])]),t._v(" "),a("ol",[a("li",[a("p",[t._v("流程\n")]),a("div",{staticClass:"mxgraph",staticStyle:{"max-width":"100%",border:"1px solid transparent"},attrs:{"data-mxgraph":'{"highlight":"#0000ff","nav":true,"resize":true,"toolbar":"zoom layers lightbox","edit":"_blank","xml":"<mxfile host=\\"Electron\\" modified=\\"2020-05-14T11:14:17.609Z\\" agent=\\"5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.0.3 Chrome/80.0.3987.163 Electron/8.2.1 Safari/537.36\\" etag=\\"9t8FgF_QWNsh-Md1boEL\\" version=\\"13.0.3\\" type=\\"device\\"><diagram id=\\"vgxLtz8AvesaW2gzkEBG\\" name=\\"Page-1\\">5VhLb6MwEP41PrbijTmShGwPrbRSDts9rZzgAluII3CapL9+x2BCHMhjNyJUWimK7M8eY2bmmwfIHGfbbzlZxS8spCkytHCLzAkyDFt34V8AuwowsVUBUZ6EFaQ1wCz5pBWo1+g6CWkhsQrijKU8Wanggi2XdMEVjOQ526jb3lgaKsCKRLQFzBYkbaM/kpDHFYoNt8GfaBLF9ZN1x6tWMlJvlm9SxCRkmwPIDJA5zhnj1SjbjmkqdKfqZXpidX+xnC75NQLB+9jg1mY2/fi1efIK8vK+2DyY8m58V78wDeH95ZTlPGYRW5I0aNBRztbLkIpTNZg1e54ZWwGoA/ibcr6TxiRrzgCKeZbKVbhwvnuV8uXkp5g82vV0sj1cnOzkrLqruOBJFUioYOt8Qc+8d+1KJI8oP7PP2BsKHJyyjMJ9QC6nKeHJh3oPIl0t2u9rrAEDaZC/MI4894Oka/kkFNhopCE8RYGDRlj8YIBxidgIw6qJAg95LvJhv5PCu43mOYwiMUIBLsXNUipAvl1KTZHf4QdpChwT9t7ECaezFSkVugGWq9aUl6Q5p9vzdmnrUQqYTiUhY4RlVNNNQzi9ZlF8QDas9aR4u1PxoFEPi4E3Rj4eljgNV34qVOmdOMaVxLEGJY7WYUBLsAVPvpolBwuB11qyyuA3mFKKfmcJXHHPecvACumxoZ5Q3UsKHfnD/hb/7iJGh4c4pT/4pYcECI9lbPU0FLjI8xGULgKZloiHfAN5ExFSYTNEVRGawa/sljvlMcvm6+IukdTQrIuh1HbuGErd/5Rd1rXsOmHPW9ll6oofmNaRgXuml9WdQYExQVly+MjXSsK5aOSUFQuwZ9qmjuIJd6CP7ilq0+tu5VIp4vTFH70dT74wgeg24a/1GTA+kIJZIyQmfVT115b1+rB1vdNmh+GQTPjzcl6sSqXIeVW3iz0lXyApYVcmKMhIlxkk9PpM5tCUKwYmaRItYbwAHdMcAEGbBNpeXy5kSRhWvkSL5JPMy/OEuVYiZJQasUfInpzjnezJpTDad8KHpj3j9CdZ+qA9utpRopMNzI1h03AfXb3r3PoI9vZW0F4ipt7V7bVqi7oQ4UlGBy00LF3Vv+4OXWnoXSVdu5KDNmAkfjIL6W0t3jnnOI59lHOubH/7yznesDlnsOa2/ljZf9V2m33cDk+HTODIUCHLrDPtzOWe5c4ksExTIYHdHwdg2nx0raJ38+XaDP4A</diagram></mxfile>"}'}}),t._v(" "),a("script",{attrs:{type:"text/javascript",src:"https://app.diagrams.net/js/viewer.min.js"}}),a("p")]),t._v(" "),a("li",[a("p",[t._v("流程说明")])])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("流程")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("未完成的提额记录")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据uid，taskType = '01'，status= 2，date(createOn)=date(now())查询user_grow_pkg_line 的 createOn最大的一条记录")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("增加时长")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("将客户端传的时长，添加到查询到的记录的time")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("新增未完成记录")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("新增user_grow_pkg_line记录：  "),a("br"),t._v("     uid 为 当前用户uid"),a("br"),t._v("    taskType = '01'"),a("br"),t._v("    createOn 为 当前时间"),a("br"),t._v("    status = 2"),a("br"),t._v('    money：查询系统参数growRedPackBase 中"01"中的minAmount和maxAmount，组成闭区间，在闭区间内随机取值，不小于0.01，只能有 2 位小数'),a("br"),t._v("    time为客户端传的时长")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("记录的time")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据uid，taskType = '01'，status= 2，date(createOn)=date(now())查询user_grow_pkg_line 的 createOn最大的一条记录的time")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("指定时长")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("1. 统计今天玩小游戏提额成功的次数：根据uid，taskType = '01'，status= 1，date(createOn)=date(now())查询user_grow_pkg_line 的记录数"),a("br"),t._v('2. 指定时长：查询系统参数growRedPackBase 中"01"中的count中的第 '),a("code",[t._v("今天玩小游戏提额成功的次数 + 1")]),t._v(" 个值")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("完成任务")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据uid，taskType = '01'，status= 2，date(createOn)=date(now())查询user_grow_pkg_line 的 createOn最大的一条记录，将status 改为 0")])])])])])}),[],!1,null,null,null);e.default=i.exports}}]);