(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{301:function(t,e,a){"use strict";a.r(e);var i=a(28),l=Object(i.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"任务修改超时"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#任务修改超时"}},[t._v("#")]),t._v(" 任务修改超时")]),t._v(" "),a("p",[a("strong",[t._v("需求类型：")])]),t._v(" "),a("ul",[a("li",[t._v("新增")])]),t._v(" "),a("p",[a("strong",[t._v("流程：")])]),t._v(" "),a("div",{staticClass:"mxgraph",staticStyle:{"max-width":"100%",border:"1px solid transparent"},attrs:{"data-mxgraph":'{"highlight":"#0000ff","nav":true,"resize":true,"toolbar":"zoom layers lightbox","edit":"_blank","xml":"<mxfile host=\\"Electron\\" modified=\\"2020-05-09T03:04:30.539Z\\" agent=\\"5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.0.3 Chrome/80.0.3987.163 Electron/8.2.1 Safari/537.36\\" etag=\\"INh7onqRo1JHxAYG4P3G\\" version=\\"13.0.3\\" type=\\"device\\"><diagram id=\\"5ciFLsmy_cbrnOC9gKqy\\" name=\\"Page-1\\">7Vtbb+o4EP4t+2D1qUexc8F5TCDdXensRerDac+bIS5kFTAKpkB//dqJQwiGYracGPZUqoQ9sRNnZr6ZL2MXuP3p+teCzCd/sJTmADnpGrgDgBB0cCB+pGRTSbCjBOMiSyuR0wgeszdaz1TSZZbShZJVIs5YzrN5Wzhisxkd8ZaMFAVbtYe9sDxtCeZkTDXB44jkuvRblvKJegvUa+S/0Ww8qZ8Mg7C6MiX1YPUmiwlJ2WpH5CbA7ReM8ao1XfdpLpXX1svDkavbhRV0xk0mPP9530/JejH0afQ2//b6/emv3+/VXRZ8U78wTcX7qy4r+ISN2YzkSSONC7acpVTe1RG9ZsxXxuZCCIXwH8r5RhmTLDkTogmf5upq9Uz5oKOvUq+LLYsRfWf9SLkEKcaUvzMObxUuPJWyKeXFRswraE549tpeB1EuM96Oa7QqGkqxZyhZLfKV5Ev1JJB4II7lX+IDHIEIlpIHECUgCUAo2iFIMIgDgP1S0pNtzVZ5LnAgbbKaZJw+zkmprJWA4iGNv9KC0/X7Otd1pCYg9XiFY+RV3VUDClh7+mQHENj5QUp1daWigEzli8+GC/lTOui+zIK7CwUXmyc1v+w8y84Xv+4O1rsXBxvVuyBMAkOYQGQTJ94tWYeuM/7UjBS95/qOot1Mkh2LFkWhTYv6J0H6izFKv5Kh4BYt25E8G89EeyTURwshkBEuE8k7UhemWZpWbkIX2RsZlveTlpizbMbLt/Vj4A/eC5GKWajJTT7ftdpxdz4aT++dL7gHcXUvY2uo2/0tl98E470J7OVlIZxi33jbNfx3ewZGmawnGyJdibwlwj/WOUYxYdPhctFJ3vKc3snE5QUdJq7eLUW5C0YsbBixApsBCx9w8J70boylO0cDECFJzARPix3p8vEAhL7u4C17dUDO6kCinNw1ZGfBj3Ly8DQ7q/tjXvacT662y8FMyJpvEyn1B/pt2McyWzO2qV26BqE5bHN+zifWzZE36Bw2xA57Q0476MLb4nK1T7ZyneBwDyB6AEkoEx0OlCQsyZxIdDLphQD3pNAmqwsQui5WBw3qEfvQ+Ux6e7nMJOlZreRB70xec2X2bUz63LLo9dgX2bXvgYKFjIAiGobll65g+2FTjxWhUDb0ulWXoRC7V/aBCw9UCfTSrBhw58C7nzXemX4NI6sVWdgzNiW6+wx1Z5r2SIGwI9MeKnVUZA+WhQ0MsFuGugGIyj2oOAKh/tHXZaiDjg+vLNYZFDo+iZ4Wz0zQYbUOiKxUN6zo2WrFAZ2uOPyPd4jQySIDxKHXiniq98Eiw31nVYbaD1tpBsujDmFcFtIhwP2SWmNZXb+uKgNEgX9d+Qa5P2ve8Ezj2UcJczk1Kgqy2RmgooEOqK2n+O2ClADurrFPTwi8PeeolnBZMB4oX0igOfJPbm/1QZzoiOt4Mws6QTvmQT/UYdfpdhbSt/i6hB08D3aWNzvQbZxNQUcOM+wdwjM43lBlL/F5hBx9c79z9Hgq8lzNXjC6qRMPtsFjXD2wC55D1YOPgufAQaGOwYN9p515AmQbPHqBgc5SHVCmJ4HJYl4dk3/J1lKxl6HJYXsnFGFdbfgyh4NFtzkyX/Gi5h8P3ORf</diagram></mxfile>"}'}}),t._v(" "),a("script",{attrs:{type:"text/javascript",src:"https://app.diagrams.net/js/viewer.min.js"}}),t._v(" "),a("p",[a("strong",[t._v("请求URL：")])]),t._v(" "),a("ul",[a("li",[t._v("计时器查询 user_attend_task_line 是否有修改超时的记录")]),t._v(" "),a("li",[t._v("修改超时的条件：\n"),a("ul",[a("li",[t._v("user_attend_task_line 的 status = '04'")]),t._v(" "),a("li",[t._v("（24小时 + user_attend_task_line 的 auditOn）>= now()")])])])]),t._v(" "),a("p",[a("strong",[t._v("请求参数：")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("参数名")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("userid")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("用户标识")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("appid")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("任务标识")])])])]),t._v(" "),a("p",[a("strong",[t._v("流程说明：")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("流程")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("操作说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("终止任务")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("1. 根据appid，uid 查询 user_attend_app_line 表中 status = '01' 的记录，修改status 为 '06'，endOn 为 当前时间"),a("br"),t._v("2. 根据appid，uid 查询 user_attend_task_line 表中 status = '01' 的记录，修改status 为 '06'，reject_reason 为 （原文本+“驳回后24小时内未修改，已终止”）")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("任务状态")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据appid 查询 app_task_info 表中的 status")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("可领取数量")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("1. 根据appid 查询 app_task_plan 表中的 start_time <= now() 的 release_num 总和  → 已投放份数"),a("br"),t._v(" 2. 根据appid 查询user_attend_app_line表中status = '01' 的任务记录数  → 进行中份数 "),a("br"),t._v(" 3. 已投放份数 - 进行中份数  → 可领取数量")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("剩余时间")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("1. 根据appid 查询 app_task_info 表中的downdt → 截止时间 "),a("br"),t._v(" 2. 截止时间 - now() → 剩余时间")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("发布来源")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据appid 查询 app_task_info 表中的ori_type ： 01 表示 运营发布 ； 02 表示 渠道发布")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("退款")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("1. 根据 appid 查询 app_task_info 中的渠道标识 ruid ,title,seller_pay_price")]),a("br"),t._v(" "),a("br"),a("strong",[t._v("2. 在 fn_io_record 中添加渠道的退款记录:")]),a("br"),t._v("    comment = '任务【 "),a("code",[t._v("title")]),t._v(" 】审核终止，任务已过期，退款'，"),a("br"),t._v("    trade_type = '3071' ， "),a("br"),t._v("    money = "),a("code",[t._v("seller_pay_price")]),t._v("/100"),a("br"),a("br"),a("strong",[t._v("3. 增加渠道的余额（sys_user 中的 free_money) + "),a("code",[t._v("seller_pay_price")]),t._v("/100")])])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("进行中数量")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据appid 查询user_attend_app_line表中status = '01' 的任务记录数")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("修改任务状态 为 1")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据appid 修改 app_task_info 表中的status 为 1")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("修改任务状态 为 7")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据appid 修改 app_task_info 表中的status 为 7")])])])])])}),[],!1,null,null,null);e.default=l.exports}}]);