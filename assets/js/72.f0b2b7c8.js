(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{296:function(t,e,a){"use strict";a.r(e);var l=a(28),i=Object(l.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"任务审核终止"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#任务审核终止"}},[t._v("#")]),t._v(" 任务审核终止")]),t._v(" "),a("p",[a("strong",[t._v("需求类型：")])]),t._v(" "),a("ul",[a("li",[t._v("梳理")])]),t._v(" "),a("p",[a("strong",[t._v("流程：")])]),t._v(" "),a("div",{staticClass:"mxgraph",staticStyle:{"max-width":"100%",border:"1px solid transparent"},attrs:{"data-mxgraph":'{"highlight":"#0000ff","nav":true,"resize":true,"toolbar":"zoom layers lightbox","edit":"_blank","xml":"<mxfile host=\\"Electron\\" modified=\\"2020-05-09T03:33:51.366Z\\" agent=\\"5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.0.3 Chrome/80.0.3987.163 Electron/8.2.1 Safari/537.36\\" etag=\\"eKd10RXE5lPFQgNxQQeY\\" version=\\"13.0.3\\" type=\\"device\\"><diagram id=\\"9h6YAUx54ih1gNyI4Pl4\\" name=\\"Page-1\\">7Vtfb+I4EP8s92D1qavYCYnzmEB6d9o/Wqla3fYxEEOyCpgLpsB++rMThxAMxVxpDLuVKuGZ2Ik9M7+Z8dgFdn+6/rOI5+lnmpAcICtZA3sAEIIWdvmP4GwqDrYkY1JkScWyGsZj9pPUIyV3mSVkIXkVi1Gas2zeZo7obEZGrMWLi4Ku2t3GNE9ajHk8IQrjcRTnKvefLGGpXAXyGv5fJJuk9Zeh61dPpnHdWa5kkcYJXe2w7AjY/YJSVrWm6z7JhfDacnk48nQ7sYLMmM6A8eO3b0v8cRiOn0bp396Xf6cuuZdvWbBNvWCS8PVLkhYspRM6i/Oo4YYFXc4SIt5qcarp84nSOWdCzvxBGNtIZcZLRjkrZdNcPq2+KT50dCn1vOiyGJEX5o+kScTFhLAX+uGtwLmlEjolrNjwcQXJY5Y9t+cRS5OZbPs1UuUNKdgzhCwn+RznS/klEDkgDMVf1AM4AAEUjSAqGy4ILBBiEHmiA8YlZwACpOoqzzkOhE5WacbI4zwuhbXiUDwk8WdSMLJ+WeaqjOQAW+JW4th2KnLVgALWlp7uAAJbbyRUWxUqcuOpWPhsuBA/pYHu8wyYOxdwsfkux5fEkyA+9GpysN59ONhI6oIwcTVhApFJnDi3pB2yztj3piennuo38nYzSBAGNYp8kxrtnQTpH9oo/RQPeW7R0l2cZ5MZb4+4+EjBGcLDZTx4B/LBNEuSykzIIvsZD8v3CU3MaTZj5Wp7IegNXnKRMrOQg5t4vqu14+Z81J/eWx+wB3H1Lm1tyNd9FdNvnPHeADoeL7hR7CtvO4f/r09XK5J5ohG6Im5x94/VHKNI6XS4XHQStxzonQxcjtth4PJuyctd0GNhTY/lmnRY+ICBK2lYhEWqFlrC5MMB8Huqgbf09fZGzs21ZeSOZnbmvpWR+6ezs5qesJKy3nO13RxMJ1nrmURKvUG/Df0Yzta0dWo2XYNQH7Y5O2eLdXPJG7QOK2Ine0NW2+nC28rlaptsxTqewz2A4AFEvgh02JUcv0zmeKATQc8H2BNMk1mda6PryuqgRj1iHzrvQW8vlukEPaOVPOicmddcmX4blT61NHo9+kVm9XugYCE8IPeGfrnT5dm+X7pCr9zg+mVDrVt16Qqxc2UbXHigSqCWZnmHOwve/a7+Tnc3jIxWZOvaiYYq0d27qztTtUcKhB2p9lCpo0r2ysOoEANsl65uAIKeaIQB8NVNX5euDlouvDJfp1HoeE/0FH+mgw6jdUBkpLphRM5GKw7odMXhFz4hQieLDBD7TsvjSeqVRYb7zqoMtR22wgwGIQ8zYVlIhwD3y9Qai+r6dVUZIPJ61xVvkP27xg1H15+9NmEuhwZFEW92OkhvoAJqayluuyAFfX9X2acHeM6ecVRTuCwYD5QvBNAs8SeOt/ogjFTEdXyYBS2v7fO2d+qMHWch9YivS9jB82Bn+LAD3cbdFHTkMsODONwVcYi3fa3rDVX04tsjZKmH+52jx5Ge52rOgtFN3XgwDR7t6oFZ8ByqHrwWPAcuCnUMHlyDoI48HjINHrXAQGaJCijdm8DxYl5dkx9nayHYi7gce+8kFPmq2PBlLgdzsrkyX+VFzT8e2NF/</diagram></mxfile>"}'}}),t._v(" "),a("script",{attrs:{type:"text/javascript",src:"https://app.diagrams.net/js/viewer.min.js"}}),t._v(" "),a("p",[a("strong",[t._v("请求URL：")])]),t._v(" "),a("ul",[a("li",[t._v("管理后台任务审核接口："),a("code",[t._v("/app-task/user-attend/audit")])]),t._v(" "),a("li",[t._v("移动端任务管理后台审核接口："),a("code",[t._v("/my/seller-app-task/audit")])])]),t._v(" "),a("p",[a("strong",[t._v("请求参数：")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("参数名")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("子参数")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("data")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("json string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("存在多条记录批量处理的情况")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("id")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("用户参与记录的标识,对应user_attend_task_line表id")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("appid")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("任务标识")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("status")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("任务状态，终止传'06'")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("remark")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("驳回原因")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("phone")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("用户手机号")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("uid")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("用户标识")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("taskid")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("appid对应little_app_task_info 的id")])])])]),t._v(" "),a("p",[a("strong",[t._v("流程说明：")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("流程")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("操作说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("终止任务")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("1. 根据appid，uid 查询 user_attend_app_line 表中 status = '01' 的记录，修改status 为 '06'，endOn 为 当前时间"),a("br"),t._v("2. 根据appid，uid 查询 user_attend_task_line 表中 status = '01' 的记录，修改status 为 '06'，reject_reason 为 前端传的remark")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("任务状态")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据appid 查询 app_task_info 表中的 status")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("可领取数量")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("1. 根据appid 查询 app_task_plan 表中的 start_time <= now() 的 release_num 总和  → 已投放份数"),a("br"),t._v(" 2. 根据appid 查询user_attend_app_line表中status = '01' 的任务记录数  → 进行中份数 "),a("br"),t._v(" 3. 已投放份数 - 进行中份数  → 可领取数量")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("剩余时间")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("1. 根据appid 查询 app_task_info 表中的downdt → 截止时间 "),a("br"),t._v(" 2. 截止时间 - now() → 剩余时间")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("发布来源")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据appid 查询 app_task_info 表中的ori_type ： 01 表示 运营发布 ； 02 表示 渠道发布")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("退款")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("1. 根据 appid 查询 app_task_info 中的渠道标识 ruid ,title,seller_pay_price")]),a("br"),t._v(" "),a("br"),a("strong",[t._v("2. 在 fn_io_record 中添加渠道的退款记录:")]),a("br"),t._v("    comment = '任务【 "),a("code",[t._v("title")]),t._v(" 】审核终止，任务已过期，退款'，"),a("br"),t._v("    trade_type = '3072' ， "),a("br"),t._v("    money = "),a("code",[t._v("seller_pay_price")]),t._v("/100"),a("br"),a("br"),a("strong",[t._v("3. 增加渠道的余额（sys_user 中的 free_money) + "),a("code",[t._v("seller_pay_price")]),t._v("/100")])])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("进行中数量")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据appid 查询user_attend_app_line表中status = '01' 的任务记录数")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("修改任务状态 为 1")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据appid 修改 app_task_info 表中的status 为 1")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("修改任务状态 为 7")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据appid 修改 app_task_info 表中的status 为 7")])])])])])}),[],!1,null,null,null);e.default=i.exports}}]);